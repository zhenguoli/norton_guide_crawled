


<html>
<head>
<meta name=keywords content="ClipX - DOS 5.0 Ref. - <b>function 45h            duplicate file handle</b>, intraSYS international, Clipper CGI, ClipX.Lib, eMailX, MsgX, Norton Guides, Apache, xBase++, IS2WCGI.DLL, dBase, FoxPro, Norton Guides, vDbase, C/C++, ng2Html By Dave Pearson">
<meta name=description content="On-line Norton Guide for DOS 5.0 Ref. - <b>function 45h            duplicate file handle</b>">
<title>function 45h            duplicate file handle</title>
<style type="text/css">
<!--
A
{
color:black;
text-decoration:none
}
a:hover
{
background-color:blue;
color:white;
}
-->
</style>
</head>
<body bgcolor="white">
<br>
<a href="ng132d3.html">[&lt;&lt;Previous Entry]</a> <a href="ng254.html">[^^Up^^]</a> <a href="ng13c94.html">[Next Entry&gt;&gt;]</a> <a href="index.html">[Menu]</a> <a href="credits.html">[About The Guide]</a>
<hr><pre>
<B>Function 45h            Duplicate File Handle</B>

    Creates a new file handle that can be used to read from or write
    to the same file or device that is associated with the original
    handle.

        <B>Entry</B>   AH = 45h
                BX = Handle to duplicate

        <B>Return</B>  AX = Duplicate file handle
                or
                AX = Error code, if CF is set
                     | 04h No handles available
                     | 06h Invalid handle

    ------------------------------------------------------------------

    If this function is used to duplicate the handle of an open file,
    the file pointer for the new handle is set to the same position as
    the pointer for the open handle. Using either handle to read from
    or write to the file changes the file pointer for both handles.

    Duplicate File Handle can also be used to keep a file open while
    its directory entry is changed. If a program creates a duplicate
    handle and then closes the duplicate handle, the file's directory
    entry is updated (and buffers flushed), but the original handle
    remains open (and the file pointer unchanged).

    ------------------------------------------------------------------

    <B>Example</B>

        ; Pre-DOS 3.30 commit file
        mov     bx,[file_handle]        ; Handle of open file
        mov     ah,45h                  ; Force Duplicate Handle
        int     21h
        jc      @@error
        mov     bx,ax                   ; bx = duplicate handle
        mov     ah,3eh                  ; Close duplicate
        int     21h
        jc      @@error
</pre><hr><b>See Also:</b> <a href="ng13c94.html">46h</a> <a href="ng1f845.html">67h</a> <a href="ng1fcb1.html">68h</a> <a href="ng19dc7.html">59h</a> <a href="ngb40a.html">4400h</a> <a href="ng3f36d.html">StdDevices</a> <pre></pre>


</html>

